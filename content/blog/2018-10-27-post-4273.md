---
title: macOS をインターネットカフェの PC のように再起動で初期化させる方法
author: KEINOS
type: post
date: 2018-10-27T05:25:55+00:00
url: /20181027_4273
yuzo_related_post_metabox:
  - 'a:3:{s:17:"yuzo_include_post";s:0:"";s:17:"yuzo_exclude_post";s:0:"";s:21:"yuzo_disabled_related";N;}'
post_views_count:
  - 400
outline_none:
  - 1
categories:
  - MacOSX
tags:
  - macOS HighSierra (OSX10.13)
  - macOS Mojave (OSX10.14)
  - sandbox/サンドボックス
  - ペアレンタルコントロール

---
## Mac をサンドボックスっぽくして再起動で「なかったこと」にしたい {#outline__1}

「初期化」や「[サンドボックス][1]」は語弊があるかもしれません。しかし、やりたいのは「ログアウトしたら**必要最低限の設定を終えた状態に戻す**」、つまり一般ユーザーの変更、作成データをなかったことにしたいのです。

遊んでいる macOS を、家族／シェアハウス／ゲストハウスなどで、**特定多数で利用したい**が色々と面倒。そんな以下の条件にマッチしたかた向けの記事です。

  * [TimeMachine][2]、[Docker][3] や [VirtualBox][4] などは使わず、**OS の標準機能で簡単**に出来ないか。
  * ネットカフェのように**「再起動」 or 「ログアウト」で保存されたデータを消去したい**。
  * アカウントの**管理が面倒**である。
  * 触れる**アプリを限定したい**。（できることをシンプルにしたい）
  * メンテナンス性を優先したい。

[「Mac ネットカフェ 初期化」をググって][5]も、基本すぎるからかピンポイントで出てこなかったので、自分のググラビリティ補完として。

## TL;DR（概要） {#outline__2}

> ユーザーを**全員ゲストにしてしまえば良い**じゃない 

  1. アカウントを「管理者」と「ゲストユーザ」のみにし、自動ログインを「ゲストユーザ」に設定する。
  2. **一般利用者には「ゲストユーザ」を使ってもらう**。
  3. **ログアウト or 再起動すると保存されたデータは消去**される。
  4. 基本的に[ホワイトリスト形式][6]なので、許可する項目は「ペアレンタル・コントロール」で行う。

「ペアレンタル・コントロール」では以下を制限させることができます。

  * 利用できるアプリ
  * アクセスできるサイト
  * 利用時間
  * Dock の内容（アイコンの並びなど）変更
  * 位置情報の許可
  * and more &#8230; ! 
      * Safari 以外のアプリを許可した場合の注意点 
          * ゲストでログイン後、該当アプリを起動し、**関連アプリや関連サービスの利用を管理者パスワードで恒久的に許可する必要がある**ものがあります。（Chrome や Acrobat Reader など）

### 動作確認済み {#outline__2_1}

  * macOS HighSierra（OSX 10.13.6）

### リファレンスと参考文献 {#outline__2_2}

  * 「[Mac でペアレンタルコントロールを設定する][7]」| macOS ユーザガイド for Mojave 10.14 @ Apple
  * 「[Mac でペアレンタルコントロールを設定する][8]」| macOS ユーザガイド for HighSierra 10.13 @ Apple
  * 「[Finder を簡素化する][9]」（シンプル Finder）| macOS ユーザガイド for HighSierra 10.13 @ Apple
  * 「[Finder を簡素化する][10]」（シンプル Finder）| macOS ユーザガイド for Mojave 10.14 @ Apple
  * 『[Macを一時的に他人に貸す時に便利な「ゲストアカウント」』][11] @ inforati

## TS;DR（詳細と所感） {#outline__3}

### 壊れた iMac を修理してシェアしようかな {#outline__3_1}

シェアハウスに引っ越しをしてから電源が入らなくなった iMac があります。

おそらく運搬時に内部の配線が抜けたのだと思われますが、引っ越し先が京都であったため、（当時は）「Apple ストアもないしなぁ」と、いつか自分でチェックしようと考えていたさなか、諸事情で横浜にいることが多くなり、そのままにしていました。

[京都 Apple Store も出来た][12]し、自己修理ができそうにない場合は手軽に[ジーニアス][13]に相談できるようになったので、メインの MacBookPro の作業マシンを Mojave にするタイミングで、一旦京都に戻り、寝ていた（壊れていた） この iMac を修理、初期化＆スッキリさせてシェアハウスで共有しようと思いました。

その時に、<font color=green>ネットカフェの PC のように再起動なりログアウトで初期化する（特定の状態に戻す）ことが出来ないか</font>悩みました。

昔の Windows で言えば、Microsoft 純正の [Windows SteadyState][14] や、サードパーティだとネットカフェなどでよくみかけた「[Returnil][15]」といったアプリを導入したイメージです。つまり、**ユーザーの作業環境をサンドボックス化したい**ということです。

### サンドボックス を叩くべきか {#outline__3_2}

> **サンドボックス**とは、砂場、砂箱という意味の英単語で、コンピュータの分野では、ソフトウェアの特殊な実行環境として用意された、外部へのアクセスが厳しく制限された領域のことを指すことが多い。
    
> （「[サンドボックス][16]」| IT 用語辞典 @ e-Words） 

「サンドボックス」とは言ったもの、[Docker][3] や [VirualBox][4] といった開発環境向けではなく、**単純にユーザー作成のデータを初期化（削除）とアプリや設定変更の制限をしたいだけ**なので、厳密な意味でサンドボックスではありません。

[ざっと、ネットを検索する][17]と、「OS の再インストール」、 「TimeMachine からの復旧」、「リカバリー方法」ばかり出てきます。違う。違う、そうじゃないのよ。まぁ、検索用語が悪いんだども。

かといって、[VirtualBox][4] などを使うのは今回のニーズ（設定作業や使用時の時間的コスパ）に合っていません。

また、パーティションを切って、うんぬんも違います。共有パソコンを触るのに「なんちゃらと、なんちゃらのキーを押しながら電源を押して」なんて操作は面倒ですし、**操作案内マニュアルを作るのすら億劫**です。

シンプル。シンプルに行きたいのです。

### Mac 環境を KISS {#outline__3_3}

Mac の起動や終了ごときで問い合わせを受けないためにも、[KISS の原則][18]という名において、普通に横着を決め込みたいのです。

起動したらストレートにデスクトップが表示され、壁紙に「ログアウトするとデータは削除されます」と書かれているくらいのシンプルさが良いのです。使えるのも、ブラウザと Skype くらいの勢いで良いのです。

すると、「一時的に貸す場合はゲストアカウントが便利」という記事を見つけました。

> 「ゲストアカウント」とは、Macを臨時に利用するためのアカウントのことで、ログインする度に毎回新しいユーザフォルダが作られ、ログアウトするとそのユーザフォルダごとすべての内容が削除されるアカウントのことです。
    
> （『[Macを一時的に他人に貸す時に便利な「ゲストアカウント」』][11] @ inforati） 

なるほど。これは使えるんでないかい？

### 最近は「ゲストアカウント」でなく「ゲストユーザ」 {#outline__3_4}

そこで、Finder のヘルプにある「Macヘルプ」で「ゲストアカウント」を検索したのですが出てきません。

どうやら、OS のバージョンで表記が変わったようで、**macOS HighSierra では「ゲストユーザ」**になっていました。

<img width="100%" alt="スクリーンショット 2018-10-26 1.36.12.png" src="https://qiita-image-store.s3.amazonaws.com/0/78776/e8ce73a3-57ef-f591-4cc0-780618e3b954.png" />

> **Mac の「ユーザとグループ」のゲストユーザの環境設定**
    
> ほかの人を個々のユーザとして追加せず、ゲストユーザに一時的に自分の Mac を使用することを許可します。 

ヘルプを開くと色々な情報があるのですが、要約すると以下の通り。

### ゲストユーザの特徴 {#outline__3_5}

  * ログインするときにパスワードが不要。
  * ユーザやコンピュータの設定を変更できない。
  * 「共有」のリモートログインを「入」にしている場合でも、リモートでログインできない。
  * 作成したファイルは一時フォルダに保存されログアウトすると削除される。
  * **「ペアレンタルコントロール」を有効にすると、アクセスできる項目のみに利用制限できる**。
  * FileVault が「入」の場合、「Safari」を使用することのみができて、暗号化されたディスクにアクセスやファイルを作成したりできない。

### ペアレンタルコントロールとは {#outline__3_6}

<img width="780" alt="スクリーンショット 2018-10-26 17.36.31.png" src="https://qiita-image-store.s3.amazonaws.com/0/78776/72c4d7ec-9428-e5c9-7a62-d67da401e579.png" />

iTunes などで買い物をすると、「[ペアレンタルコントロール][19]」の文言はチョイチョイ見かけていました。

しかし、「ペア・レンタル・コントロール」だと思い込んでいて、「購入したものをペアにレンタル」つまり**「相方とシェアするための管理機能」だと勘違い**していました。

英語だと「`Parental Controls`」で、「ペアレント」。つまり「親による管理」の意味でした。

> **ペアレンタルコントロール**
    
> <font color=green>子供</font>によるパソコンや携帯電話などの情報通信機器の利用を、<font color=blue>親</font>が監視して制限する取り組み。
    
> 自由に設定してはいけないであろう設定事項を、パスワードをかけて<font color=green>子供</font>に設定できないようにすることが出来るシステムのことを指す。（[Wikipedia][19]） 

では、これを今回の件に利用できるか考えてみました。こういう時は単語を入れ替えてみるとわかりやすくなります。

> <font color=green>ユーザー</font>によるパソコンや携帯電話などの情報通信機器の利用を、<font color=blue>管理者</font>が監視して制限する取り組み。
    
> 自由に設定してはいけないであろう設定事項を、パスワードをかけて<font color=green>ユーザー</font>に設定できないようにすることが出来るシステムのことを指す。 

なんかそれっぽいことができそうです。

#### ペアレンタル・コントロールで制限/設定できる項目 {#outline__3_6_1}

ペアレンタル・コントロールでは、以下の 6 つの項目が設定/制限可能です。

  * アプリケーション 
      * 内臓カメラ、Game Center、メール、アプリやユーティリティなど
  * Web サイト 
      * 無制限/アダルトサイト/指定したサイトのみなど
  * App/iTunes/iBook Store/Store 
      * ユーザーが自身の Apple ID を入力して一時的に Apple コンテンツを利用するなど
      * 年齢制限コンテンツの禁止など
  * 利用時間 
      * 長時間独占させないように、１回のログインで限られた時間のみ許可する
      * 指定した時間の間のみ利用できるようにする
  * プライバシー
  * その他

### 設定方法 {#outline__3_7}

できれば、クリーンインストールを行い、ユーザーは管理者のみにするのがシンプルだと思います。

  1. [システム環境設定] &#8211; [ペアレンタルコントロール]
  2. 左下の「変更するにはカギをクリックします。」より鍵を解除。
  3. もし、同じネットワーク上に別の Mac があって、そこから管理者として管理したい場合は「ほかのコンピューターからペアレンタルコントロールを管理」にチェックを入れます。
  4. 左ペイン（左側の項目）の「ゲストユーザ」を選択し、必要な（ユーザーに許可する項目の）設定を行います。最初はガチガチに禁止にしておいて、必要になったら１つ１つ許可するのが、あとあと楽だと思いますが、「プライバシー」で**「位置情報サービス」の変更はできない**ようになっていて、かつ「プライバシーの管理」で「位置情報サービスを有効にする」にチェックが入っていることを確認します。盗まれた時に起動してネットに繋げた時点で検知できるからです。
  5. 一連の許可設定が済んだら、システム環境設定に戻り「ユーザとグループ」に入ります。
  6. 左下の「変更するにはカギをクリックします。」より鍵を解除。
  7. 左ペインの「ゲストユーザ」を選択し「ゲストにこのコンピュータへのログインを許可」と「ペアレンタル」にチェックを入れます。必要な場合は「ゲストユーザに共有フォルダへの接続を許可」にチェックを入れますが、基本的にゲストユーザには USB なり外付けハードディスクを適宜繋げてもらうのがベストだと思います。（共有フォルダに秘密のファイルを置きっ放しにする人が出てくるので）
  8. 下部の「ログインオプション」を選び、「自動ログイン」を「ゲストユーザ」にします。
  9. 一度シャットダウンして、再起動します。
 10. ゲストでログインした画面になるので、一連の操作を行い、必要なアプリがあれば起動させて管理者パスワードで許可させます。

 [1]: https://ja.wikipedia.org/wiki/%E3%82%B5%E3%83%B3%E3%83%89%E3%83%9C%E3%83%83%E3%82%AF%E3%82%B9_(%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3)
 [2]: https://ja.wikipedia.org/wiki/Time_Machine_(%E3%82%BD%E3%83%95%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A2)
 [3]: https://ja.wikipedia.org/wiki/Docker
 [4]: https://ja.wikipedia.org/wiki/VirtualBox
 [5]: https://www.google.co.jp/search?q=Mac+%E3%83%8D%E3%83%83%E3%83%88%E3%82%AB%E3%83%95%E3%82%A7+%E5%88%9D%E6%9C%9F%E5%8C%96
 [6]: https://ja.wikipedia.org/wiki/%E3%83%9B%E3%83%AF%E3%82%A4%E3%83%88%E3%83%AA%E3%82%B9%E3%83%88
 [7]: https://support.apple.com/ja-jp/guide/mac-help/mtusr004/10.14/mac/10.14
 [8]: https://support.apple.com/ja-jp/guide/mac-help/mtusr004/10.13/mac/10.13
 [9]: https://support.apple.com/ja-jp/guide/mac-help/mchlp1581/10.13/mac/10.13
 [10]: https://support.apple.com/ja-jp/guide/mac-help/mchlp1581/10.14/mac/10.14
 [11]: http://inforati.jp/apple/mac-tips-techniques/system-hints/how-to-use-the-guest-account-of-macos.html
 [12]: https://www.apple.com/jp/newsroom/2018/08/apple-kyoto-opens-on-shijo-dori/
 [13]: https://www.apple.com/jp/retail/geniusbar/
 [14]: https://en.wikipedia.org/wiki/Windows_SteadyState
 [15]: http://www.returnil.jp/discontinued
 [16]: http://e-words.jp/w/%E3%82%B5%E3%83%B3%E3%83%89%E3%83%9C%E3%83%83%E3%82%AF%E3%82%B9.html
 [17]: https://www.google.co.jp/search?q=Mac+%E5%86%8D%E8%B5%B7%E5%8B%95%E3%81%A7%E5%88%9D%E6%9C%9F%E5%8C%96
 [18]: https://ja.wikipedia.org/wiki/KISS%E3%81%AE%E5%8E%9F%E5%89%87
 [19]: https://ja.wikipedia.org/wiki/%E3%83%9A%E3%82%A2%E3%83%AC%E3%83%B3%E3%82%BF%E3%83%AB%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB