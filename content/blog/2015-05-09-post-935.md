---
title: 再起動すると「このボリューム上の所有権を無視」にチェックが入る
author: KEINOS
type: post
date: 2015-05-08T16:00:00+00:00
url: /20150509_935
page_type:
  - default
post_views_count:
  - 733
categories:
  - AFP
  - NAS
  - SMB
  - ストレージ関連
tags:
  - ACL
  - Mac OSX 10.7 Lion
  - アクセス権

---
## 「このボリューム上の所有権を無視」が再起動後、勝手にONになりフォルダ毎のアクセス権が無視されてしまう {#outline__1}

<div class="section">
  <p>
    Mac OSX10.7.5 Lion Serverで共有用の外付けHDDが共有先(ネットワーク)で丸見えになってしまいました。
  </p>
  
  <p>
    共有しているとはいえ、フォルダ単位で、ユーザやグループ毎にアクセスできるようアクセスを制限していたのですが、突然全員が見えるようになってしまったとのこと。
  </p>
  
  <p>
    タイミング的にはサーバ側の再起動が必要なアップデートを行ってからの現象のようでした。
  </p>
  
  <p>
    各フォルダの「情報を見る」と共有のアクセス権はちゃんと設定されているようだったので、大もとかな？と思い、外付けHDDの「情報を見る」と「共有とアクセス権」の「このボリューム上の所有権と無視」にチェックが入っていました。
  </p>
  
  <p>
    Serverアプリより一旦「ファイル共有」を解除した後、先ほどのチェックを外して再度共有をかけたところ元に戻りました。
  </p>
  
  <p>
    問題は、マシンを再起動すると「このボリューム上の所有権を無視」にチェックが勝手に入ってしまうことです。
  </p>
  
  <p>
    色々ググっても明確な答えが見つからず、Appleの掲示板を見ても何か的を得ていない答えばかり。質問をしても、「このチェックを入れれば見れてしまうのだから、フォルダ毎にグループごとにアクセス制限をする意味がわからない」といった、なんか、、、なぁ、、、といった人ばかり。
  </p>
  
  <p>
    フォルダのアクセス権なども再設定したりしたのですが、<a href="http://forums.macrumors.com/threads/ignore-ownership-on-this-volume-not-sticking.1721513/" target="_blank">英語のサイト(macrumors.com)</a>で逆のパターンで悩んでいる(勝手にチェックが外れてしまう)ケースを発見。
  </p>
  
  <p>
    起動パーティションに各ボリューム(ハードディスクなど)の諸情報を持っているデータベース・ファイルがあり、これらが壊れている可能性があるとのこと。これを削除して、再作成させてもダメな場合はOSのバージョン違いによるパーミッション設定の不具合が原因とのこと。
  </p>
  
  <p>
    <span><br /> sudo rm /var/db/volinfo.database<br /> </span>
  </p>
  
  <p>
    削除してもダメだったので、システム関連のアカウントのアクセス権やらで、どうやら再フォーマットしてアクセス権を設定するのが急がばまわれらしいのです。
  </p>
  
  <p>
    でも数テラあるデータ、かつ常にアクセスされているため、そうは問屋が卸さないのがつらいところ。
  </p>
  
  <p>
    サーバマシンなため普段は起動しっぱなしなので暫定処置で運用してますが、根本的な原因がわからないので気持ちが悪いのです。
  </p>
</div>