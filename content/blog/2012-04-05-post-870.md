---
title: ”hbdllmain.ccp:89 指定されたパスが見つかりません。”エラー
author: KEINOS
type: post
date: 2012-04-04T16:00:00+00:00
url: /20120405_870
page_type:
  - default
post_views_count:
  - 371
categories:
  - Windows
tags:
  - Windows7

---
<div class="section">
  <h4 id="outline__1">
    「hbdllmain.ccp 指定されたパスが見つかりません」エラー
  </h4>
  
  <p>
    ある時から（再起動含め）Windows7(@iMac via Bootcamp)起動時に「対話型サービスの検出」エラーのダイアログが表示されるようになりました。ダイアログを閉じれば良いのですが、起動時に毎回というのが邪魔で邪魔で。
  </p>
  
  <p>
    そして、このダイアログの詳細を開くと下記エラーの内容が。
  </p>
  
  <pre>
メッセージ タイトル：エラー
プログラムのパス：C:\Windows\System32\spoolsv.exe
受信日時：2012年xx月xx日 xx:xx:xx
</pre>
  
  <p>
    で、ダイアログのボタンを押して、メッセージ内容を見ると下記の通り。
  </p>
  
  <pre>
hbdllmain.cpp:89 指定されたパスが見つかりません。
</pre>
  
  <h4 id="outline__2">
    現象環境
  </h4>
  
  <p>
    環境としては、iMacにBootcampでWindows7を起動しています。いちおうVMware Fusion4も入れていますが、どちらでも現象が出るようになりました。
  </p>
  
  <p>
    体感的には&#8221;Pogoplug&#8221;が、&#8221;Pogoplug PC&#8221;やらPogoplug Buckup&#8221;に変わったあたりのような気がするのですが、いまいち確信が持てません。
  </p>
  
  <h4 id="outline__3">
    暫定回避方法:　スプーラーのサービスを停止
  </h4>
  
  <p>
    とりあえずの応急処置としては、スプーラー・サービスを止めたら、エラーは出なくなりました。
  </p>
  
  <p>
    具体的には、[スタート]-「プログラムとファイルの検索」で&#8221;msconfig&#8221;を起動して、「サービス」タブにある&#8221;Print Spooler&#8221;のチェックを外して再起動したらメッセージは出なくなりました。
  </p>
  
  <p>
    副作用としては印刷ができなくなりますが、このマシンではプリンタがないので、今はよしとします。
  </p>
  
  <h4 id="outline__4">
    考察
  </h4>
  
  <p>
    今後、忘れたころ(印刷が必要になるころ)に「印刷できん!」となると思うので、その時のための現状の考察を記録します。
  </p>
  
  <p>
    まず、エラーの内容を要約すると
  </p>
  
  <pre>
C++言語で開発されたであろう「とあるWinXP時代のアプリ」から印刷に関する命令がスプーラー・サービスに流れたが、肝心のところで指定したパスが見つからないため、スプーラーはどうしていいのか、わけわかめ。「対話型サービスの検出」サービスがそれを感知して、ドーン!、メッセージを表示。
</pre>
  
  <p>
    と言ったところでしょうか。
  </p>
  
  <p>
    &#8220;spoolsv.exe&#8221;は、印刷をする際にプリンタ用のデータ(印刷ジョブ)を溜め込んでプリンタに流すプログラム(サービス)なので、こいつを止めればエラーは出ないのはすぐにわかったのですが、そもそも印刷命令をかけているのはどいつかわからないのが気持ち悪い。
  </p>
  
  <p>
    そして、エラーを表示している、この「対話型サービスの検出」ダイアログは、旧Win環境(WinXPなど)との互換のためのWin7機能が、なんかうまく動いていない時に出るようです。→「<a href="http://msdn.microsoft.com/ja-jp/windows/dd871151.aspx" target="_blank">アプリケーション開発者向け Microsoft&#174; Windows 7 対応アプリケーションの互換性</a>」
  </p>
  
  <p>
    次に&#8221;hbdllmain.cpp&#8221;は、拡張子が&#8221;.cpp&#8221;とあるので、C++言語で開発する時に使われるコンパイル前のプログラム(スクリプト・ファイル)で、恐らく89行目に「何か」を参照しているのですが、参照先(パス)に「その何か」がないため、エラーが出たのだと思われます。
  </p>
  
  <p>
    しかし、&#8221;.cpp&#8221;ファイル自体はコンパイルして(DLLやEXEといった)実行可能な状態にしないと意味がないため、どのEXEが原因かは、この情報ではつかめません。当然&#8221;hbdllmain.cpp&#8221;も検索をかけてもヒットしません。
  </p>
  
  <p>
    今のマシンで、プリンタや印刷に関係するアプリで、常駐する系と言えば、思いつくのは&#8221;Google Chrome&#8221;と&#8221;Acrobat Reader&#8221;くらいです。
  </p>
  
  <p>
    まだ試した事はないのですが、ChromeはGoogleアカウントをブラウザに登録しておくと、プリンタがなくても印刷をかけて、別環境で同じアカウントでChromeを立ち上げると印刷できるらしいのです。AppleのAir Printに対抗して、Android端末でも印刷できるようにする布石だと思うのですが、「へー」とアカウントは登録しているものの、印刷を試したことはありません。
  </p>
  
  <p>
    でも、この機能自体は今回の現象が出るかなり前からあるので、他に原因がある気がします。
  </p>
  
  <p>
    &#8220;Windows&#8221;フォルダ内に&#8221;Temp&#8221;フォルダがない(つまり&#8221;Windows&#8221;ではなく&#8221;Winnt&#8221;にOSがインストールされている)ケースで現象が出る事があるらしく、手動で&#8221;Windows&#8221;フォルダを作り、その中に&#8221;Temp&#8221;フォルダを作成したら回避されたという報告もあります。→&#8221;<a href="http://www.pogoplugged.com/forum/thread/16270/Getting-hbdllmain.cpp-error-with-every-reboot/" target="_blank">Getting hbdllmain.cpp error with every reboot</a>&#8220;
  </p>
  
  <p>
    しかし、アチキの環境では、ちゃんと&#8221;C:\\Windows\Temp&#8221;は存在しているので該当しない気もします。
  </p>
  
  <p>
    気になる点としては、VMWare Fusion4をインストールする前のBootcampにはBuffalloの<a href="http://buffalo.jp/download/driver/memory/ramdisk.html" target="_blank">RAM DISKユーティリティ(仮想メモリ・ディスクのアプリ)</a>を使っていました。実は、アチキのiMacには無駄に16BGのメモリを積んでいるのですが、Windows7が32bitであるため、4GBしか認識しません。12GBが無駄であるため、もったいない、と。
  </p>
  
  <p>
    このメモリの空き領域を、仮想ディスクとして使って、ブラウザのキャッシュやTEMPフォルダといった、消えても差し支えないデータや、PortableAppsのような単体で起動するアプリを置くようにすることで、SSD以上の動きを満喫していたのですが、Buffaloの&#8221;RAM DISKユーティリティ&#8221;は&#8221;VMWare Fusion4&#8243;上では動かないのです。
  </p>
  
  <p>
    そもそも、テキスト・エディタが一番多いので、結局&#8221;Fusion4&#8243;の使い勝手を取ることにしました。
  </p>
  
  <p>
    先ほどの、気になる点というのは、このユーティリティが暫定的にTEMPの保存先をRAMディスクに変更することです。Windowsの環境変数を変えるだけでないようなので、ここらへんなのかも。
  </p>
</div>